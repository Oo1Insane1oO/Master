%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Chapter 4 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{\label{chapter:4}}
    We will in this chapter mentiond some popular basis-sets used in atomic
    physics and deepen into a particular set of functions called
    \txtit{Gaussian Type orbitals} and mimic the well known \txtit{Hermite
    polynomials}.

\section{Hermite Functions}
    Hermite functions are functions of the following form
        \begin{equation}
            \phi^a_n(\blds{r}) \equiv \prod_d N_d
            H_{n_d}(\sqrt{a}x_d)\exp(-\frac{a}{2}x^2_d)
            \label{eq:HermiteFunc}
        \end{equation}
    with $\blds{r} = \sum\limits_d \blds{\me}_dx_d$ and the sum over $d$ being
    the sum over the number of dimensions and the $H_n$ is the Hermite
    polynomial of order $n$. The integer $n_d$ is the order of the
    function\footnote{In quantum mechanics the number $n$ is referred to as the
    principal quantum number and is associated with the energy of a given
    orbital(energy-level) of the system.} while the parameter $a$ is a scaling
    factor and $N_d$ is a normalization factor. These functions show up as
    eigenfunctions for the \txtit{quantum harmonic oscillator
    system}\cite{GriffQuan} with the scaling parameter $a$ equal to the
    oscillator frequency ($\omega$) of the system.

    The Hermite functions are orthogonal and give a good ansatz for the VMC
    method, see \Arf{sec:QMC}, with the scaling parameter transformed with an
    additional variational parameter. The problem with these are however that
    the matrix-elements introduced in the Hartree-Fock method
    (\Arf{sec:HFtheory}) are not solveable with the Hermite functions as basis
    functions. >> REF FURTHER DISCUSSION <<

\section{Gaussian Type Orbitals}
    \txtit{Gaussian Type Orbitals} or GTO's are functions of the following form
    >> REF GTO here <<
        \begin{equation}
            G_n(\blds{\alpha};\blds{r},\blds{A}) \equiv \prod_d (x_d-A_d)^{n_d}
            \me^{-\alpha_d (x_d-A_d)^2}
            \label{eq:GTOdef1d}
        \end{equation}
    We call $\alpha$ for the scaling parameter and $i$ for the order of the
    GTO. The variable $A$ is where the function is centered. These are in many
    literatures referred to as \txtit{primitive Gaussians} and they alone
    make a poor approximation to the true wave function.

    In atomic physics these functions are used directly as a linear combination
    referred to as \txtit{contracted Gaussian functions}. These are written as
        \begin{equation}
            G_k(x, A) \equiv \sum\limits^P_{a_k=0} C_{a_k}
            G_{a_k}(\alpha_{a_k};x, A)
        \end{equation}
    and are fitted\footnote{Meaning we find the parameters $C_{a_k}.$ and
    $\alpha_{a_k}$} to \txtit{Slater-type orbitals}, which are functions with
    decaying properties(present in atomic systems), or found by some variational
    method before-hand. \\

    These functions are unfortunately not orthogonal, but they behave nicely in
    integrals and actually give an analytic expression for the
    interaction-elements mentioned in \Arf{sec:HFtheory}. For this reason we
    will go forth and use the Gaussian contracted functions and actually fit
    them to Hermite functions.

\section{Fitting GTO's to Hermite Functions with Least-Squares}
    Looking at \Arf{eq:HermiteFunc, eq:GTOdef1d} we see that both functions are
    separable in the different dimensions. For this reason we simplify to only
    work in one dimensions with label $x$ for the positions and omit the
    subscript $d$. We will also specialize to the quantum dot case where the
    imagined nuclei is centered in origo for all orbitals. The functions will
    hereby be written as
        \begin{equation}
            \begin{aligned}
                \phi_n(x) &= NH_n(\sqrt{\omega}x)\me^{-\frac{\omega}{2}x^2} \\
                G_n(x, A) &= \sum\limits^{n+1}_{b_n=0} C_{b_n}
                G_{b_n}(\alpha;x, A)
            \end{aligned}
        \end{equation}
    First observation here is that we choose the scaling parameter in the GTO
    to be equal to the oscillator frequency $\omega$ halved. We then only have
    $1$ set of coefficients to determine, namely the $\{C\}^P_{a_k}$. Note also
    that the sum in the contracted function runs to $n+1$, we will show later
    that this is sufficient to approximate the Hermite of order $n$.

    A Least-Squares problem for a continuous set $x\in\mathbb{R}$ is defined to
    be of form
        \begin{equation}
            \min_{\{a\}} \abs{\int (f(x) - \sum_ja_jg_j(x)) \md x}^2 \indent
            \forall \;\;x\in\mathbb{R}
        \end{equation}
    where we minimize with respect to a set of parameters $\{a\}$. The
    stationary point in the parameters space of the $a$'s is reached when all
    partial derivatives of $\{a\}$ is zero. This can be expressed as a linear system
        \begin{equation}
            \blds{X} \blds{a} = \blds{b}
        \end{equation}
    with the matrix $\blds{X}$ having elements
        \begin{equation}
            X_{ij} \equiv \int g_i(x)g_j(x) \md x
        \end{equation}
    and the vector $\blds{b}$
        \begin{equation}
            b_i \equiv \int g_i(x)f(x) \md x
        \end{equation}
    Inserting the Hermite function for $f$ and the GTO for $g$ the integrands
    (see \Arf{appendix:B}) we get
        \begin{equation}
            \begin{aligned}
                X_{ij} &= \int x^i N_i N_j \me^{\frac{\omega}{2} x^2} x^j
                \me^{\frac{\omega}{2} x^2} \md x \\
                b_i &= \int N_i x^i \me^{\frac{\omega}{2} x^2}
                \left(2^nn!\sqrt{\frac{\pi}{\omega}}\right)^{-\frac{1}{2}}
                H_n(\sqrt{\omega}x) \me^{\frac{\omega}{2} x^2} \md x
            \end{aligned}
        \end{equation}
    We can solve this by hand, but it is desirable to solve it using Sympy. See
    >>REF IMPLEMENTATION CHAPTER <<.

\section{Integral Elements}
    In the Hartree-Fock scheme described in \Arf{chapter:3} we need to
    calculate the integrals which define the different matrix elements. The
    integrals to be found are of the following form
        \begin{equation}
            \begin{aligned}
                \braket{i}{j} &= \infint g_i(\alpha_i;r,A)g_j(\alpha_j;r,B) \md
                \blds{r} \\
                \bra{i}x^k_d\ket{j} &= \infint g_i(\alpha_i;r,A) r^k
                g_j(\alpha_j;r,B) \md \blds{r} \\
                \bra{i}\nabla^2\ket{j} &= \infint g_i(\alpha_i;r,A)\nabla^2
                g_j(\alpha_j;r,B) \md \blds{r} \\
                \bra{ij}r^{-1}\ket{kl} &= \infint
                g_i(\alpha_i;r_1,A)g_j(\alpha_j;r_2,B) \frac{1}{r_{12}}
                g_k(\alpha_k;r_1,C)g_l(\alpha_l;r_2,D) \md \blds{r}_1 \md
                \blds{r}_2\\
            \end{aligned}
        \end{equation}
    where $\md\blds{r}$ means integration over all dimensions and with the
    $g$'s being the usual \txtit{Hermite-Gaussians} defined as
        \begin{equation}
            g_n(\alpha;\blds{r},\blds{A}) = \prod_d (x_d-A_d)^{n_d}
            \me^{-\alpha (x_d-A_d)^2}
            \label{eq:hermiteGauss2}
        \end{equation}
    We will in this chapter limit ourselves to work with isotropic gaussians
    (meaning $\alpha_d$ is the same for all dimensions) as this will yield a
    simpler closed-form solution to the integrals. >> Ref non-isotropic <<. \\
    The approach given further follows closely the excellent text by Helgaker
    >>REF<<, who calculates the integral elements in 3 dimensions.

    Before we throw ourselves out into the integrals, let us first express the
    Hermite-Gaussians in a more convenient way >> REF HELGAKER <<. The
    Gaussians can be expressed as
        \begin{equation}
            g_n(\alpha;\blds{r},\blds{A}) = \prod_d  \prdp{A_{x_d}}{n_d}
            \me^{-\alpha (x_d-A_d)^2} = \prod_d \prdp{A_{x_d}}{n_d}
            g_0(\alpha;\blds{r},\blds{A})
            \label{eq:centerDerGauss}
        \end{equation}
    Since the derivatives are with respect to the center variables we may pull
    them out of the integration meaning the integrals will only be over s-type
    Gaussians, greatly simplifying the calculations. With the mentioned
    simplification in mind, the problem is to find a closed-form expression for
    the integrals over s-type Gaussians. We proceed with the overlap element first.

    Since we only work with s-types when integrating we introduce a new notation
        \begin{equation}
            \begin{aligned}
                \bra{A}\hat{O}\ket{B} &\equiv \int g_0(\alpha;\blds{r},\blds{A})
                \hat{O} g_0(\beta;\blds{r},\blds{B}) \md\blds{r}\\
                \bra{AB}\hat{O}\ket{CD} &\equiv \int
                g_0(\alpha;\blds{r_1},\blds{A})g_0(\beta;\blds{r_2},\blds{B})
                \hat{O} g_0(\gamma;\blds{r_1},\blds{C})
                g_0(\delta;\blds{r_2},\blds{D}) \md\blds{r_1} \md\blds{r_2}\\
            \end{aligned}
        \end{equation}
    with $\hat{O}$ being 
    We also introduce the \txtit{Gaussian product rule}\footnote{Still in the
    isotropic case.} which basically states that the product of two Gaussian
    functions is just a third Gaussian centered between the center of the two.
    The expressions give
        \begin{equation}
            g_0(\alpha;\blds{r},\blds{A})g_0(\beta;\blds{r},\blds{B}) =
            K_{AB}\exp(-(\alpha+\beta)\blds{r}^2_s)
            \label{eq:gaussianProductRule}
        \end{equation}
    where
        \begin{equation}
            \begin{aligned}
                K_{AB} &\equiv \exp(-\frac{\alpha\beta}{\alpha+\beta}R^2_{AB})
                \\
                R_{AB} &= \abs{\blds{A} - \blds{B}} \\
                \blds{r_s} &= \blds{r} - \blds{P} \\
                \blds{P} &= \frac{\alpha(\blds{r}-\blds{A}) +
                \beta(\blds{r}-\blds{B})}{\alpha + \beta}
            \end{aligned}
        \end{equation}
    the vector $\blds{r}_S$ is just somewhere between $\blds{A}$ and
    $\blds{B}$(We will see that $r_S$ disappears when the integration is done).
    The Gaussian product rule greatly simplifies the integral over two Gaussian
    functions since we can just pull $K_{AB}$ out of the integration since it
    is a constant.

\subsection{Overlap Integral}
    With The simplification to s-types and the product rule, the integration
    may begin. Starting with the overlap $\braket{A}{B}$ and applying the
    Gaussian product rule(\Arf{eq:gaussianProductRule}) \footnote{And using the
    following integral $\infint \me^{-\lambda x^2} =
    \sqrt{\frac{\pi}{\lambda}},\indent \lambda>0$. >>REF ROTTMANN<<}
        \begin{align}
            \braket{A}{B} &= \infint g_0(\alpha;\blds{r},\blds{A})
            g_0(\beta;\blds{r},\blds{B}) \md\blds{r} \nonumber \\
            &= K_{AB}\infint \exp(-(\alpha+\beta)\blds{r}^2_s) \md \blds{r}
            \nonumber \\
            &= K_{AB} \left(\frac{\pi}{\alpha+\beta}\right)^{\frac{d}{2}}
            \label{eq:stypeOverlap}
        \end{align}
    The power $d/2$ comes from splitting the integral into the $d$ dimensions.
    The component-wise factors from the splitting are also substituted(i.e
    $u=x-P_x$)

\subsection{Potential Integral}
    The second integral with the $x^k_d$ part shows up in the external
    potential part of the Hamiltonian and again with the Gaussian product rule
    the expression gives
        \begin{align}
            \bra{A}x^k_d\ket{B} &= \infint g_0(\alpha_i;r,A) x^k_d
            g_0(\alpha_j;r,B) \md \blds{r} \nonumber \\
            &= K_{AB} \infint x^k_d \exp(-(\alpha+\beta)\blds{r}^2_s)
            \md\blds{r} \nonumber \\
            &= K_{AB} \left(\frac{\pi}{\alpha+\beta}\right)^{\frac{D-1}{2}}
            \infint (u+P_d)^k\exp(-(\alpha+\beta)u^2) \md u \nonumber \\
            &= K_{AB} \left(\frac{\pi}{\alpha+\beta}\right)^{\frac{D-1}{2}}
            \sum\limits_{l=0}^k {k\choose l} P^{k-l}_d \infint
            u^l\exp(-(\alpha+\beta)u^2) \md u \nonumber \\
            &= K_{AB} \left(\frac{\pi}{\alpha+\beta}\right)^{\frac{D-1}{2}}
            \sum\limits_{l=0}^k {k\choose l}
            \frac{P^{k-l}_d}{2(\alpha+\beta)^{\frac{l}{2}}}
            \left((-1)^l+1\right) \Gamma\left(\frac{l+1}{2}\right)
        \end{align}
    The integrals are split in each dimension and the dimensions not equal to
    $d$(in $x^k_d$) are pulled out and the approach in \Arf{eq:stypeOverlap} is
    applied. The integral over dimension $d$ is then substituted with
    $u=x_d+P_d$. In line four $(u+P_d)^k$ is rewritten with the \txtit{binomial
    expansion}\footnote{The integral $\infint x^n\me^{-ax^2}\md x =
    \frac{1}{2}a^{-\frac{n}{2}}\Gamma\left(\frac{k+1}{2}\right),\indent n>-1,
    n\;\text{even}$, >> REF THIS <<< is used as well.}.

\subsection{Laplacian Integral}
    The third integral with the Laplacian operator arises in the kinetic part
    of the Hamiltonian. This integral can be expressed in terms of
    \Arf{eq:stypeOverlap}, the overlap integral, however the Laplacian applied
    to a Hermite-Gaussian has to be calculated first
        \begin{align}
            \nabla^2 g_i(\alpha;\blds{r},\blds{A}) &= \sum_d \prd{x_d}[][2]
            \left(\prod_{d'} \left(x - A_{d'}\right)^{i_{d'}}_{d'} \exp(-\alpha
            \left(x_{d'} - A_{d'}\right)^2)\right)\nonumber \\
            &= \sum_d \prod_{d'\neq d} g_{i,d'} \prd{x_d}[][2]\left(\left(x_d -
            A_d\right)^{i_d} \exp(-\alpha \left(x_d - A_d\right)^2)\right)
            \nonumber \\
            &= \sum_d \prod_{d'\neq d} g_{i,d'} g_{i,d}
            \left(4\alpha^2\left(x_d-A_d\right)^{i_d+2} -
            2\alpha\left(2i_d+1\right)\left(x_d-A_d\right)^{i_d} +
            i_d\left(i_d-1\right)\left(x_d-A_d\right)^{i_d-2}\right) \nonumber
            \\
            &= g_i\sum_d \left(4\alpha^2\left(x_d-A_d\right)^{i_d+2} -
            2\alpha\left(2i_d+1\right)\left(x_d-A_d\right)^{i_d} +
            i_d\left(i_d-1\right)\left(x_d-A_d\right)^{i_d-2}\right)
        \end{align}
    Now for the integral we have
        \begin{align}
            \bra{i}\nabla^2\ket{j} &= \infint
            g_i(\alpha;\blds{r},\blds{A})\nabla^2g_j(\beta;\blds{r},\blds{B}) 
            \md\blds{r} \nonumber \\
            &= \sum_d\prod_{d'\neq d}
            \bra{i_{d'}}\sigma_{d'}(S_d(\beta;x-B_d))\ket{j_{d'}}
            \label{eq:laplacianIntegral}
        \end{align}
    with
        \begin{equation}
            \begin{aligned}
                S_d(\alpha;x_d-A_d) &\equiv
                \left(4\alpha^2\left(x_d-A_d\right)^{i_d+2} -
                2\alpha\left(2i_d+1\right)\left(x_d-A_d\right)^{i_d} +
                i_d\left(i_d-1\right)\left(x_d-A_d\right)^{i_d-2}\right) \\
                \sigma_d(S_d) &\equiv \left\{\begin{matrix}
                                            1,&\indent d' \neq d \\
                                            S_d,&\indent d' = d
                                            \end{matrix}
                                        \right.
            \end{aligned}
        \end{equation}
    meaning the Laplacian integral can be expressed in terms of the overlap
    integrals $\braket{i}{j+2}$, $\braket{i}{j}$ and
    $\braket{i,i-2}$\footnote{Since $xg_i=g_{i+1}$ and
    $\frac{g_i}{x}=g_{i-1}$.}. Notice also that the expression in
    \Arf{eq:laplacianIntegral} is over two Hermite-Gaussians.

\subsection{Coulomb Potential Integral}
    Lastly, the troublesome\footnote{Damn inverse term prevents dimensional
    decomposition.} Coulomb integral needs to be calculated. Due to the $1/r$
    term we cannot split the integral in each respective dimension as
    previously. Before we approach the full Coulomb integral, lets calculate a
    simpler integral over a so-called \txtit{Coulomb Potential distribution}
        \begin{equation}
            \infint \me^{-\alpha\left(\blds{r} - \blds{A}\right)^2}
            \frac{1}{\abs{\blds{r} - \blds{B}}} \md\blds{r}
        \end{equation}
    The calculation of this integral will be beneficial for the calculation of
    the Coulomb integral as we can reuse most of the tricks used. With
    \Arf{eq:gaussianProductRule}, the Gaussian product rule, in mind. We
    rewrite the inverse term with
        \begin{equation}
            \infint \me^{r^2_B t^2} \md t = \frac{\sqrt{\pi}}{r_B} \Rarr
            \frac{1}{r_B} = \frac{1}{\sqrt{\pi}} \infint \me^{r^2_Bt^2} \md t
            \label{eq:onelectronTrick1}
        \end{equation}
    The Coulomb potential integral is thus, with
    \Arf{eq:gaussianProductRule}(again the product rule)
        \begin{align}
            \infint\infint \me^{-\alpha\left(\blds{r} - \blds{A}\right)^2}
            \frac{1}{\abs{\blds{r} - \blds{B}}} \md\blds{r} &=
            \frac{1}{\sqrt{\pi}}\infint \me^{-\alpha\left(\blds{r} -
            \blds{A}\right)^2} \me^{t^2(\blds{r} - \blds{B})^2} \md\blds{r} \md
            t \nonumber \\
            &= \frac{1}{\sqrt{\pi}} \infint\infint \me^{-\frac{\alpha
            t^2}{\alpha + t^2}\left(\blds{A} - \blds{B}\right)^2}
            \me^{-(\alpha+t^2)r^2_S} \md\blds{r} \md t \nonumber \\
            &= \frac{1}{\sqrt{\pi}} \infint \left(\frac{\pi}{\alpha +
            t^2}\right)^{\frac{d}{2}} \me^{-\frac{\alpha t^2}{\alpha +
            t^2}\left(\blds{A} - \blds{B}\right)^2} \md t
            \label{eq:coulombPotentialIntegral}
        \end{align}
    The integral over $t$ has to be addressed separately for two- and three
    dimensions. For the three-dimensional case the reader is referred to >> REF
    HELGAKER <<. Here we will derive a closed-form form expression for the
    two-dimensional case. First let us use the following substitution
        \begin{equation}
            \begin{aligned}
                u &= \frac{t}{\sqrt{\alpha+t^2}} \\
                t &= u\sqrt{\frac{\alpha}{1-u^2}} \\
                \frac{\md u}{\md t} &= \frac{\alpha}{(\alpha + t^2)^{\frac{3}{2}}} \\
                \lim\limits_{t\rarr -\infty} u(t) &= -1 \\
                \lim\limits_{t\rarr \infty} u(t) &= 1 \\
            \end{aligned}
        \end{equation}
    The integrand(ignoring the exponential part) is then
        \begin{align}
            \frac{\md t}{\alpha + t^2} &= \frac{1}{\alpha + t^2} \frac{(\alpha +
            t^2)^{\frac{3}{2}}}{\alpha} \nonumber \\
            &= \frac{\sqrt{\alpha + t^2}}{\alpha} \nonumber \\
            &= \frac{t}{\alpha u} \nonumber \\
            &= \frac{1}{\alpha u} u\sqrt{\frac{1}{1-u^2}} \nonumber \\
            &= \frac{1}{\alpha}\sqrt{\frac{1}{1-u^2}}
        \end{align}
    giving
        \begin{align}
            I_{\text{2D}} = \frac{1}{\alpha}\int\limits^1_{-1}
            \frac{1}{\sqrt{1-u^2}} \me^{-\alpha u^2\abs{\blds{A} - \blds{B}}^2}
            \md u
            \label{eq:oneElectron2D}
        \end{align}
    and for the three-dimensional case we have a simpler form
        \begin{align}
            I_{\text{3D}} = \frac{1}{\alpha}\int\limits^1_{-1} \me^{-\alpha
            u^2\abs{\blds{A} - \blds{B}}^2} \md u
            \label{eq:oneElectron3D}
        \end{align}
    These integrals must be solved numerically. One can also rewrite the
    2D-integral in terms of the \txtit{Modified Bessel function of first kind}
    by using $u^2=1/2(1 - \cos(\theta)$ >> REF WOLFRAM(MATHWORKS) <<. The
    3D-integral can rewritten with an \txtit{incomplete Gamma function} >>REF
    HELGAKER<<. From \Arf{eq:centerDerGauss}, the integrals have to be
    differentiated in order to get the final closed form expressions, see
    \Arf{sub:445}.

\subsection{Coulomb Interaction Integral}
    In the previous an expression for integral over a Coulomb potential was
    derived. Before we embark on a journey into the full Coulomb interaction
    integral, another exercise with simpler interaction integral is worthwhile.
    The integral in question is
        \begin{equation}
            \infint \me^{-\alpha(\blds{r}-\blds{A})^2}
            \me^{-\beta(\blds{r}-\blds{B})^2}
            \frac{1}{\abs{\blds{r} - \blds{C}}} \md\blds{r}
            \label{eq:coulombInteractionSimple}
        \end{equation}
    This is an interaction between two distributions. Firstly, notice that we
    can rewrite the distribution centered in $\blds{A}$ and the Coulomb
    interaction with the previously calculated Coulomb potential integral given
    in \Arf{eq:coulombPotentialIntegral}. Using $I_D$ as a general label for
    \Arf{eq:oneElectron2D,eq:oneElectron3D} we have
        \begin{equation}
            \infint \me^{-\alpha(\blds{r}-\blds{A})^2}
            \me^{-\beta(\blds{r}-\blds{B})^2} \frac{1}{\abs{\blds{r} -
            \blds{C}}} \md\blds{r} = \infint
            I_D(\alpha;\abs{\blds{A}-\blds{C}}) \me^{-\beta(\blds{r} -
            \blds{B})^2} \md\blds{r}
        \end{equation}
   
\subsection{Recurrence Relation\label{sub:445}}
    Following >>REF HELGAKER<<, we proceed with finding a similar recurrence
    relation for the derivatives. We define a function containing the integral
    which needs to be solved numerically
        \begin{equation}
            \begin{aligned}
                \zeta_n(x) &\equiv \int\limits^1_{-1} \frac{u^{2n}}{\sqrt{1 -
                u^2}} \me^{-u^2x} \md u \\
                \prd{x}[\zeta_n] &= \zeta_{n+1}
            \end{aligned}
            \label{eq:zetaDef}
        \end{equation}
    The Coulomb potential integral is then, in terms of $\zeta_n(x)$
        \begin{equation}
            \twoDI = \frac{1}{\alpha} \zeta_0\left(\alpha R^2_{AB}\right)
        \end{equation}
    and the first derivative with respect to $A_x$ is
        \begin{align}
            \prd{A_x}[\twoDI] &= \frac{1}{\alpha} \prd{A_x}
            \zeta_0\left(\alpha R^2_{AB}\right) \nonumber \\
            &= 2X_{AB}\zeta_1\left(\alpha R^2_{AB}\right)
        \end{align}
    With this we define an auxiliary function
        \begin{equation}
            \begin{aligned}
                \xi^n_{tu} &=\prdp{A_x}{t}\prdp{A_y}{u} \xi^n_{00} \\
                \xi^n_{00} &= (-2)^n\alpha^{n-1} \zeta_n\left(\alpha
                \xi^2_{AB}\right)
            \end{aligned}
        \end{equation}
    and take a look at the incrementation of $t$
        \begin{align}
            \xi^n_{t+1,u} &= \prdp{A_x}{t}\prdp{A_y}{u} \prd{A_x}[\xi^n_{00}]
            \nonumber \\
            &= \prdp{A_x}{t}X_{AB}\xi^{n+1}_{0u}
            \label{eq:Rtincr}
        \end{align}
    Using the commutator between
    $\prtl^t_{A_x}$\footnote{$\prtl^t_x=\prd{x}[][t]$}
        \begin{align}
            \prd{A_x}[][t] X_{AB} &= \left[\prd{A_x}[][t], X_{AB}\right] +
            X_{AB}\prd{A_x}[][t] \nonumber \\
            &= t\prd{A_x}[][t-1] + X_{AB}\prd{A_x}[][t]
        \end{align}
    the final form of \Arf{eq:Rtincr} is\footnote{The incrementation of $u$ is
    derived in the exact same manner as with $t$.}
        \begin{equation}
            \begin{aligned}
                \xi^n_{t+1,u} &= t\xi^{n+1}_{t-1,u} + X_{AB}\xi^{n+1}_{t,u} \\
                \xi^n_{t,u+1} &= u\xi^{n+1}_{t,u-1} + Y_{AB}\xi^{n+1}_{t,u}
            \end{aligned}
        \end{equation}
    With this all Hermite integrals of order $t+u\leq N$ can be calculated from
    $\zeta$ of order $n\leq N$, the only difference being $X_{AB}$ and $Y_{AB}$.

\subsection{Coulomb Distribution Integral}
    With the derived expressions for the Coulomb potential integral the full
    two-body distribution can be treated. The expression with the
    simplification in \Arf{eq:centerDerGauss} gives(still in two dimensions)
        \begin{align}
            \bra{ij}\frac{1}{r_{12}}\ket{kl} &= \prtl^{ijkl}_{ABCD}
            \bra{AB}\frac{1}{r_{12}}\ket{CD} \nonumber \\
            &= \prtl^{ijkl}_{ABCD} \infint\infint
            \me^{-\alpha(\blds{r_1}-\blds{A})}
            \me^{-\beta(\blds{r_2}-\blds{B})} \frac{1}{r_{12}}
            \me^{-\gamma(\blds{r_1}-\blds{C})}
            \me^{-\delta(\blds{r_2}-\blds{D})} \md\blds{r_1}\md\blds{r_2}
            \nonumber \\
            &= \prtl^{ijkl}_{ABCD} \frac{1}{\sqrt{\pi}}\infint\infint\infint
            K_{AC}K_{BD}
            \me^{-(\alpha+\gamma)r^2_{1S}}\me^{-(\beta+\delta)r^2_{2P}}
            \me^{r^2_{12}t^2} \md\blds{r_1}\md\blds{r_2} \md t \nonumber \\
            &= \prtl^{ijkl}_{ABCD} \frac{1}{\sqrt{\pi}}\infint\infint\infint
            K_{AC}K_{BD}K_S(t,\blds{r_2}) \me^{-(\alpha+\gamma+t^2)r^2_{St}}
            \me^{-(\beta+\delta)r^2_{2P}} \md\blds{r_1}\md\blds{r_2} \md t
            \nonumber \\
            &= \prtl^{ijkl}_{ABCD}
            \frac{K_{AC}K_{BD}}{\sqrt{\pi}}\infint\infint K_S(t)
            \frac{\pi}{\alpha+\gamma+t^2} \me^{-(\beta+\delta)r^2_{2P}}
            \md\blds{r_2} \md t \nonumber \\
            &= \prtl^{ijkl}_{ABCD} K_{AC}K_{BD}\pi^{\frac{3}{2}}\infint
            \frac{1}{\mu t^2 + \nu(\mu+t^2)} \me^{-\mu\nu\frac{t^2}{\mu t^2 +
            \nu(\mu + t^2)}\left(\blds{R_{AC}}+\blds{R_{BD}}\right)^2} \md t
            \nonumber \\
            &= \frac{\pi^{\frac{3}{2}}}{\mu\nu}\prtl^{ijkl}_{ABCD} K_{AC}K_{BD}
            \int\limits^1_{-1} \frac{1}{\sqrt{1 - u^2}} \me^{-\mu\nu
            \left(\blds{R_{AC}}+\blds{R_{BD}}\right)^2 u^2} \md u \nonumber \\
            &= \frac{\pi^{\frac{3}{2}}}{\mu\nu}\prtl^{ijkl}_{ABCD} K_{AC}K_{BD}
            \zeta_0\left(\mu\nu\left(\blds{R_{AC}}+\blds{R_{BD}}\right)^2\right)
        \end{align}
    using the notation
        \begin{equation}
                 \prtl^{ijkl}_{ABCD} = \prdp{A_x}{i_x}\prdp{A_y}{i_y}
                 \prdp{B_x}{j_x}\prdp{B_y}{j_y} \prdp{C_x}{k_x}\prdp{C_y}{k_y}
                 \prdp{D_x}{l_x}\prdp{B_y}{l_y}
        \end{equation}
    defining
        \begin{equation}
            \begin{aligned}
                \mu &\equiv \alpha + \gamma \\
                \nu &\equiv \beta + \delta \\
                \blds{R_{AC}} &= \alpha\blds{A} - \gamma\blds{C} \\
                \blds{R_{BD}} &= \beta\blds{B} - \delta\blds{D} \\
            \end{aligned}
        \end{equation}
    and using the substitution
        \begin{equation}
            u = \frac{t}{\mu t^2 + \nu(\mu + t^2)}
        \end{equation}
